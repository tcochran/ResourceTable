<h2>Books</h2>

<a href="" class="sort" data-sort-direction="ASC" data-sort-key="name" >sort by name</a><br/>
<a href="" class="sort" data-sort-direction="ASC" data-sort-key="author" >sort by author</a><br/>

<table>
  <thead>
    <th>Name</th>
    <th>Author</th>
    <th>Subject</th>
    <th>Quantity</th>
  </thead>
  <tbody>

  </tbody>
</table>

<select name="author" class="filter">
  <%= options_for_select @authors %>
</select>



<div id="pagination-summary"></div>

<script id="rubbish" type='template'>
  <tr>
    <td>{{ name }}</td>
    <td>{{ author }}</td>
    <td>{{ subject }}</td>
    <td>{{ quantity }}</td>
  </tr>
</script>

<script>
  var compiled = _.template($("#rubbish").html());



  $("table").resourceTable( { 
    url: "http://localhost:3000/books", 
    renderDataCallBack: function(data) { 
      $("tbody").empty();
      _.each(data, function(row) { $("tbody").append(compiled(row)) });
    },
    paginationElement: $("#pagination-summary")
  });

  $(".sort").click(function(){
    var element = $(this);
    var key = element.data("sort-key");
    var direction = element.data("sort-direction");
    $("table").resourceTable("sort", key, direction);
    return false;
  });

  $(".filter").change(function(){
    var element = $(this);
    var key = element.attr("name");
    var filter = {}
    filter[key] = element.val();
    $("table").resourceTable("filter", filter );
    return false;
  });



</script>




